<!DOCTYPE html>
<html lang="en"><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
    <title>Dependencies</title>
    <meta name="description" content="Dependencies" />
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" type="text/css" media="screen,projection" href="/assets/materialize.css" />
    <link rel="canonical" href="/tutorials/maven_only_tutorial/dependencies.html" />
    <link rel="alternate" type="application/rss+xml" title="modularcode" href="/feed.xml" />
    
</head>
<!-- Is it a content or a nested page -->
	
	
	
	<style>a {color: #757575;fill:#424242;}a:hover {color: #03a9f4;fill:#03a9f4;}h1,h2,h3,h4,h5,h6{color: #424242;}body{color: #212121; display: flex; min-height: 100vh; flex-direction: column;}nav ul a{color: #424242;}nav .brand-logo{color: #424242}.justify-align{text-align:justify;}nav a{color: #424242;}main{flex: 1 0 auto;}.side-nav li>a{color: #424242;}.side-nav .collapsible-header, .side-nav.fixed .collapsible-header{padding-left:32px;}.side-nav .collapsible-body li a, .side-nav.fixed .collapsible-body li a{padding-left:47px;}h1,h2,h3,h4,h5,h6{-webkit-font-smoothing: antialiased;}.icon-block{padding: 0 15px;}.icon-block .material-icons{font-size: inherit;}.row{margin-bottom:0px;}.logo img{padding-top:3px;}.page-footer{background-color:#03a9f4; padding-top: 0px;}.nav-button{width:20px; height:20px; viewBox:0 0 20 20;}footer h5{color:#FFFFFF;}hr{background-color:#bdbdbd;}.divider{background-color:#bdbdbd;}img{max-width: 100%; height: auto;}.page-footer .footer-copyright{background-color:#03a9f4;}/* Code Highlighting */.highlight .c { color: #bdbdbd; font-style: italic } /* Comment */.highlight .k { color: #212121; font-weight: bold } /* Keyword */.highlight .cm { color: #bdbdbd; font-style: italic } /* Comment.Multiline */.highlight .c1 { color: #bdbdbd; font-style: italic } /* Comment.Single */.highlight .kc { color: #424242; font-weight: bold } /* Keyword.Constant */.highlight .kd { color: #212121; font-weight: bold } /* Keyword.Declaration */.highlight .kn { color: #424242; font-weight: bold } /* Keyword.Namespace */.highlight .kp { color: #424242; font-weight: bold } /* Keyword.Pseudo */.highlight .kr { color: #424242; font-weight: bold } /* Keyword.Reserved */.highlight .kt { color: #424242; font-weight: bold } /* Keyword.Type */.highlight .s { color: #757575 } /* Literal.String */.highlight .n { color: #03a9f4 } /* Name */.highlight .na { color: #03a9f4 } /* Name.Attribute */.highlight .nc { color: #03a9f4} /* Name.Class */.highlight .nd { color: #757575 } /* Name.Decorator */.highlight .nf { color: #03a9f4 } /* Name.Function */.highlight .mf { color: #757575 } /* Literal.Number.Float */.highlight .mh { color: #757575 } /* Literal.Number.Hex */.highlight .mi { color: #757575 } /* Literal.Number.Integer */.highlight .mo { color: #757575 } /* Literal.Number.Oct */.highlight .sb { color: #757575 } /* Literal.String.Backtick */.highlight .sc { color: #757575 } /* Literal.String.Char */.highlight .sd { color: #757575 } /* Literal.String.Doc */.highlight .s2 { color: #757575 } /* Literal.String.Double */.highlight .se { color: #757575 } /* Literal.String.Escape */.highlight .sh { color: #757575 } /* Literal.String.Heredoc */.highlight .si { color:#757575 } /* Literal.String.Interpol */.highlight .sx { color: #757575 } /* Literal.String.Other */.highlight .sr { color: #757575 } /* Literal.String.Regex */.highlight .s1 { color: #757575 } /* Literal.String.Single */.highlight .ss { color: #757575 } /* Literal.String.Symbol */.highlight {tab-size: 4;}div.highlighter-rouge{padding:5px;background:#f5f5f5;border:1px solid #bdbdbd;border-radius:4px;}div.highlight pre.highlight{margin:0px;}code.highlighter-rouge{padding:0px 3px;background:#f5f5f5;border:1px solid #bdbdbd;border-radius:3px;}/* Make headers a little bit smaller */h1{font-size:2.8rem;}h2{font-size:2.5rem;}h3{font-size:2.1rem;}h4{font-size:1.8rem;}h5{font-size:1.3rem;}h6{font-size:1rem;}/* Plain text */p{text-align:justify;}/* Blockquotes */blockquote{border-left:3px solid #03a9f4;font-style:italic;font-weight:300;}/* Tables */table.striped>tbody>tr:nth-child(odd){background-color:#f5f5f5;}/* Cards */.card .card-image .card-title{color: #212121; font-weight: 600; padding-bottom: 0px; padding-left:12px; padding-right: 12px;}.card-content{color: #757575;}.card .card-content{padding-top: 5px;}.card .card-action a:not(.btn):not(.btn-large):not(.btn-large):not(.btn-floating){color: #424242;}.card .card-action a:not(.btn):not(.btn-large):not(.btn-large):not(.btn-floating):hover{color: #03a9f4;}.card.small{height: 225px;}.card-placeholder-image{color:#bdbdbd;}.card-image img{opacity: 0.3;}.card-image h2{opacity: 0.3;}.card .card-image{min-height:60%;}/* Breadcrumbs */nav{background-color: #FFFFFF;}a.breadcrumb{color: #757575;}.breadcrumb:last-child{color:#03a9f4;}.breadcrumb:before{color:#757575;font-size:15px;}nav.breadcrumbs{box-shadow:none;margin-top:4px;}ul.collapsible{list-style-type: none;padding:0px;}.collapsible-header{border-bottom:0px;}.collapsible-body{padding:5px;}/* Table of Contents */.second-level{padding:0px;}.table-of-contents .second-level a{padding-left:40px;font-size:13px;}.table-of-contents a{color:#757575;}.table-of-contents a:hover{border-left:1px solid #03a9f4;color:#03a9f4;}.table-of-contents a.active{border-left:2px solid #03a9f4;color:#757575;}.toc-wrapper li{padding:1px;}/* Navigation Arrows */.prev-nav{top: 50%;left: 3%;position:fixed;}.next-nav{top: 50%;right: 3%;position:fixed;}</style>

  <body>
	<!-- Navigation Header -->
	<nav class="white lighten-1" role="navigation">
	<div class="nav-wrapper container">
		<a id="logo-container" class="brand-logo logo show-on-medium-and-up hide-on-small-only" href="/"><img src="/logo.png"></a>
		<a id="logo-container" class="brand-logo logo show-on-small hide-on-med-and-up" href="/"><img src="/logo-small.png"></a>
	  
	  
	
	  <ul class="right hide-on-med-and-down">
		
			
			<li><a href="/tutorials.html">Tutorials</a></li>
		
			
			<li><a href="/modules.html">Modules</a></li>
		
			
			<li><a href="/projects.html">Projects</a></li>
		
			
			<li><a href="/contribute.html">Contribute</a></li>
		
		
			<li>
				<a title="modularcode.site on GitHub" href="https://github.com/Sandared/modularcode.site"> 
					<svg class="nav-button" xmlns="http://www.w3.org/2000/svg">
						<title>github</title>
						<path d="M10 0C4.477 0 0 4.477 0 10c0 4.418 2.865 8.166 6.839 9.489.5.092.682-.217.682-.482 0-.237-.008-.866-.013-1.7-2.782.603-3.369-1.342-3.369-1.342-.454-1.155-1.11-1.462-1.11-1.462-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.087 2.91.831.092-.646.35-1.086.636-1.336-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.268 2.75 1.026A9.578 9.578 0 0 1 10 4.836c.85.004 1.705.114 2.504.337 1.909-1.294 2.747-1.026 2.747-1.026.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.579.688.481C17.137 18.163 20 14.418 20 10c0-5.523-4.478-10-10-10" fill-rule="evenodd">
						</path>
					</svg>					
				</a>
			</li>
		
		
		
			<li>
				<a title="SanfteSchorle on Twitter" href="https://twitter.com/SanfteSchorle"> 
					<svg class="nav-button" xmlns="http://www.w3.org/2000/svg">
						<title>twitter</title>
						<path d="M15.115 7.788c.005.11.009.223.009.335 0 3.43-2.611 7.384-7.386 7.384-1.467 0-2.831-.43-3.98-1.166a5.244 5.244 0 0 0 3.843-1.075 2.596 2.596 0 0 1-2.424-1.801 2.645 2.645 0 0 0 1.171-.045 2.597 2.597 0 0 1-2.082-2.544v-.033c.351.194.752.311 1.177.324a2.59 2.59 0 0 1-1.154-2.16c0-.475.127-.92.35-1.305A7.37 7.37 0 0 0 9.99 8.414a2.596 2.596 0 0 1 4.423-2.367 5.174 5.174 0 0 0 1.648-.63 2.602 2.602 0 0 1-1.142 1.436 5.17 5.17 0 0 0 1.491-.41 5.233 5.233 0 0 1-1.295 1.345M10 0C4.486 0 0 4.486 0 10s4.486 10 10 10 10-4.486 10-10S15.514 0 10 0" fill-rule="evenodd">
						</path>
					</svg>			
				</a>
			</li>
		
	  </ul>

	  <ul id="nav-mobile" class="side-nav">
		<li><a href="">Home</a></li>
		<li class="divider"></li>
		
			
			<li><a href="/tutorials.html">Tutorials</a></li>
			<li class="divider"></li>
		
			
			<li><a href="/modules.html">Modules</a></li>
			<li class="divider"></li>
		
			
			<li><a href="/projects.html">Projects</a></li>
			<li class="divider"></li>
		
			
			<li><a href="/contribute.html">Contribute</a></li>
			<li class="divider"></li>
		
		
			<li>
				<a title="modularcode.site on GitHub" href="https://github.com/Sandared/modularcode.site"> 
					<svg class="nav-button" xmlns="http://www.w3.org/2000/svg">
						<title>github</title>
						<path d="M10 0C4.477 0 0 4.477 0 10c0 4.418 2.865 8.166 6.839 9.489.5.092.682-.217.682-.482 0-.237-.008-.866-.013-1.7-2.782.603-3.369-1.342-3.369-1.342-.454-1.155-1.11-1.462-1.11-1.462-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.087 2.91.831.092-.646.35-1.086.636-1.336-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.268 2.75 1.026A9.578 9.578 0 0 1 10 4.836c.85.004 1.705.114 2.504.337 1.909-1.294 2.747-1.026 2.747-1.026.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.579.688.481C17.137 18.163 20 14.418 20 10c0-5.523-4.478-10-10-10" fill-rule="evenodd">
						</path>
					</svg>					
				</a>
			</li>
			<li class="divider"></li>
		
		
		
			<li>
				<a title="SanfteSchorle on Twitter" href="https://twitter.com/SanfteSchorle"> 
					<svg class="nav-button" xmlns="http://www.w3.org/2000/svg">
						<title>twitter</title>
						<path d="M15.115 7.788c.005.11.009.223.009.335 0 3.43-2.611 7.384-7.386 7.384-1.467 0-2.831-.43-3.98-1.166a5.244 5.244 0 0 0 3.843-1.075 2.596 2.596 0 0 1-2.424-1.801 2.645 2.645 0 0 0 1.171-.045 2.597 2.597 0 0 1-2.082-2.544v-.033c.351.194.752.311 1.177.324a2.59 2.59 0 0 1-1.154-2.16c0-.475.127-.92.35-1.305A7.37 7.37 0 0 0 9.99 8.414a2.596 2.596 0 0 1 4.423-2.367 5.174 5.174 0 0 0 1.648-.63 2.602 2.602 0 0 1-1.142 1.436 5.17 5.17 0 0 0 1.491-.41 5.233 5.233 0 0 1-1.295 1.345M10 0C4.486 0 0 4.486 0 10s4.486 10 10 10 10-4.486 10-10S15.514 0 10 0" fill-rule="evenodd">
						</path>
					</svg>			
				</a>
			</li>
			<li class="divider"></li>
		
	  </ul>        

	  <a data-activates="nav-mobile" class="button-collapse"><i class="material-icons">menu</i></a>
	</div>
</nav>
	
	
	
  <main>	
  <div class="container">
		<div class="row">	
		
			<div id="text-content" class="section col s12 l10">
				


<nav class="breadcrumbs">
	<div class="nav-wrapper">
	
	
		
	
		
			
			
			
			
			
							
				
				
							
				
				
							
				
				
			
				
					
					<a href="/tutorials.html" class="breadcrumb">Tutorials</a>
				
			
		
	
		
			
			
			
			
			
							
				
				
							
				
				
							
				
				
					
				
				<a href="/tutorials/maven_only_tutorial.html" class="breadcrumb">Maven ONLY Tutorial</a>
				
			
		
	
		
			
			
			
			
			
							
				
				
							
				
				
							
				
				
					
				
				<a href="/tutorials/maven_only_tutorial/dependencies.html" class="breadcrumb">Dependencies</a>
				
			
		
	
	</div>
</nav>

				<h1 id="dependencies">Dependencies</h1>

<h2 id="what-you-will-learn-in-this-section">What You Will Learn in this Section</h2>

<p>In this section we will replace the rather simplistic parser with an external
dependency from Maven Central. This dependency is <a href="https://github.com/scireum/parsii">Parsii</a>, a very lightweight expression
parser.</p>

<p><img src="img/parsii-diagram.png" alt="API Diagram" /></p>

<p>Make sure you are in the top directory:</p>

<div class="shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cd ~/workspaces/osgi.enroute.examples.eval
</code></pre></div></div>

<h2 id="create-project">Create Project</h2>

<p>Create a new project for the osgi.enroute.examples.parsii.provider in the <code class="highlighter-rouge">parsii.provider</code>
directory of the <code class="highlighter-rouge">osgi.enroute.examples.eval</code> directory. The <code class="highlighter-rouge">pom.xml</code> file should look like:</p>

<div class="shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>osgi.enroute.examples.eval $ mkdir parsii.provider
osgi.enroute.examples.eval $ cd parsii.provider
parsii.provider $ vi pom.xml
// add following pom
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;project 
	xmlns="http://maven.apache.org/POM/4.0.0" 
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"
&gt;
	&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
	
	&lt;parent&gt;
		&lt;groupId&gt;org.osgi&lt;/groupId&gt;
		&lt;artifactId&gt;osgi.enroute.examples.eval&lt;/artifactId&gt;
		&lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;
	&lt;/parent&gt;

	&lt;artifactId&gt;osgi.enroute.examples.eval.parsii.provider&lt;/artifactId&gt;
	&lt;description&gt;Eval Provider based on Parsii library&lt;/description&gt;

	&lt;dependencies&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;com.scireum&lt;/groupId&gt;
			&lt;artifactId&gt;parsii&lt;/artifactId&gt;
			&lt;version&gt;2.3&lt;/version&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.osgi&lt;/groupId&gt;
			&lt;artifactId&gt;osgi.enroute.examples.eval.api&lt;/artifactId&gt;
			&lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;
		&lt;/dependency&gt;
	&lt;/dependencies&gt;
&lt;/project&gt;
</code></pre></div></div>

<p>This is quite similar to the simple provider that we had earlier but now with
an extra dependency for the Parsii parser.</p>

<h2 id="source-code">Source Code</h2>

<p>We can use the following source code:</p>

<div class="shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>parsii.provider $ mkdir -p src/main/java/osgi/enroute/examples/eval/parsii/provider
parsii.provider $ vi src/main/java/osgi/enroute/examples/eval/parsii/provider/EvalImpl.java
// Add the following code
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">osgi</span><span class="o">.</span><span class="na">enroute</span><span class="o">.</span><span class="na">examples</span><span class="o">.</span><span class="na">eval</span><span class="o">.</span><span class="na">parsii</span><span class="o">.</span><span class="na">provider</span><span class="o">;</span>
	
<span class="kn">import</span> <span class="nn">org.osgi.service.component.annotations.Component</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.osgi.service.component.annotations.Reference</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.osgi.service.log.LogService</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">osgi.enroute.examples.eval.api.Eval</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">parsii.eval.Parser</span><span class="o">;</span>

<span class="nd">@Component</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"osgi.enroute.examples.eval.parsii.provider"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EvalImpl</span> <span class="kd">implements</span> <span class="n">Eval</span> <span class="o">{</span>

	<span class="nd">@Reference</span>
	<span class="n">LogService</span> <span class="n">log</span><span class="o">;</span>
	
	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="kt">double</span> <span class="nf">eval</span><span class="o">(</span><span class="n">String</span> <span class="n">expression</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">Parser</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">expression</span><span class="o">).</span><span class="na">evaluate</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p class="note">The reference to the log service is not used. This line was added to solve
a bug in bnd that should soon be solved. The problem was that for a very simple
DS use no <code class="highlighter-rouge">osgi.extender</code> requirement is included.</p>

<h2 id="bundle-layout">Bundle Layout</h2>

<p>The bnd.bnd file is a bit more complex than the simple provider we made before. The
reason is that the dependency we added is not a bundle, we can therefore not
depend on this JAR in the runtime. In these cases, there are two different tracks
to take. You can either <em>wrap</em> this bundle or <em>include</em> it. Wrapping a bundle means
creating a new project and providing the OSGi metadata. Including the JAR means
including the required packages from the JAR with bnd’s Private-Package instruction.</p>

<p>In this example we’ve selected the including strategy. The bnd.bnd file therefore looks as
follows:</p>

<div class="shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>parsii.provider $ vi bnd.bnd
// add the following bnd.bnd
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Export-Package: osgi.enroute.examples.eval.api

Private-Package: \
	parsii.*, \
	osgi.enroute.examples.eval.parsii.provider
</code></pre></div></div>

<p>Just like the simple provider, we’ve exported the API. However, where we’ve used
the default of all classes from the project for the simple provider, here we
explicitly list the packages that we want included.</p>

<p class="note">Maven does not clean the classes directory for a build automatically. This means
that only after a <code class="highlighter-rouge">mvn clean</code> can you be assured of the right content. In practice,
it is easy to end up with classes from long gone experiments with the bnd.bnd file.</p>

<h2 id="building">Building</h2>

<p>Again, don’t forget to add the parsii.provider module to the parent pom.</p>

<p>We now build the bundle:</p>

<div class="shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>parsii.provider $ mvn install
...
parsii.provider $ bnd print target/osgi.enroute.examples.eval.parsii.provider-1.0.0-SNAPSHOT.jar 
[MANIFEST osgi.enroute.examples.eval.parsii.provider-1.0.0-SNAPSHOT]
Bnd-LastModified                         1475601027531                           
Build-Jdk                                1.8.0_25                                
Built-By                                 aqute                                   
Bundle-ManifestVersion                   2                                       
Bundle-Name                              osgi.enroute.examples.eval.parsii.provider
Bundle-SymbolicName                      osgi.enroute.examples.eval.parsii.provider
Bundle-Version                           1.0.0.201610041710                      
Created-By                               1.8.0_25 (Oracle Corporation)           
Export-Package                           osgi.enroute.examples.eval.api;version="1.0.0"
Import-Package                           osgi.enroute.examples.eval.api;version="[1.0,1.1)"
Manifest-Version                         1.0                                     
Private-Package                          parsii.tokenizer,parsii.eval,osgi.enroute.examples.eval.parsii.provider
Provide-Capability                       osgi.service;objectClass:List&lt;String&gt;="osgi.enroute.examples.eval.api.Eval"
Require-Capability                       osgi.ee;filter:="(&amp;(osgi.ee=JavaSE)(version=1.8))"
Service-Component                        OSGI-INF/osgi.enroute.examples.eval.parsii.provider.xml
Tool                                     Bnd-3.3.0.201609221906                  

[IMPEXP]
Import-Package
  osgi.enroute.examples.eval.api         {version=[1.0,1.1)}
Export-Package
  osgi.enroute.examples.eval.api         {version=1.0.0, imported-as=[1.0,1.1)}
</code></pre></div></div>

<p>The Private-Package header added by bnd clearly shows that we’ve added the <code class="highlighter-rouge">parsii</code> packages that it found in the bundle. We specified a wild card in the <code class="highlighter-rouge">bnd.bnd</code> file for Private-Package but in the manifest we can clearly see that there are <code class="highlighter-rouge">parsii.tokenizer</code> and <code class="highlighter-rouge">parsii.eval</code> packages on the classpath.</p>

<h2 id="running-it">Running It</h2>

<p>We should now switch to the bndrun project.</p>

<div class="shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>parsii.provider $ cd ../bndrun
parsii.provider $ vi pom.xml
// replace dependencies with next section
</code></pre></div></div>

<p>We first need to replace the simple provider with our newly eval parser in the pom.xml in this project so
it can be used by the resolver. The dependencies should therefore look like:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      &lt;dependencies&gt;
            &lt;dependency&gt;
                    &lt;groupId&gt;org.osgi&lt;/groupId&gt;
                    &lt;artifactId&gt;osgi.enroute.examples.eval.parsii.provider&lt;/artifactId&gt;
                    &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                    &lt;groupId&gt;org.apache.felix&lt;/groupId&gt;
                    &lt;artifactId&gt;org.apache.felix.gogo.shell&lt;/artifactId&gt;
                    &lt;version&gt;1.0.0&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                    &lt;groupId&gt;org.osgi&lt;/groupId&gt;
                    &lt;artifactId&gt;osgi.enroute.examples.eval.command&lt;/artifactId&gt;
                    &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                    &lt;groupId&gt;org.osgi&lt;/groupId&gt;
                    &lt;artifactId&gt;osgi.enroute.pom.distro&lt;/artifactId&gt;
                    &lt;version&gt;2.0.0&lt;/version&gt;
            &lt;/dependency&gt;
    &lt;/dependencies&gt;
</code></pre></div></div>

<p>In the bndrun project in the <code class="highlighter-rouge">osgi.enroute.examples.eval.bndrun</code> file, we need to 
change the <code class="highlighter-rouge">-runrequires</code> to use the <code class="highlighter-rouge">parsii.provider</code> instead of the simple provider:</p>

<div class="shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>parsii.provider $ cd ../bndrun
bndrun $ vi osgi.enroute.examples.eval.bndrun
// Replace the -runrequires
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-runrequires: \
	osgi.identity;filter:='(osgi.identity=org.apache.felix.gogo.shell)',\
	osgi.identity;filter:='(osgi.identity=org.apache.felix.gogo.command)',\
	osgi.identity;filter:='(osgi.identity=osgi.enroute.examples.eval.command)',\
	osgi.identity;filter:='(osgi.identity=osgi.enroute.examples.eval.parsii.provider)'
</code></pre></div></div>

<p>Then resolve, which should give something like:</p>

<div class="shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bndrun $ mvn install
...
-runbundles: \
	org.apache.felix.configadmin; version='[1.8.8,1.8.9)',\
	org.apache.felix.gogo.command; version='[0.16.0,0.16.1)',\
	org.apache.felix.gogo.runtime; version='[0.16.2,0.16.3)',\
	org.apache.felix.log; version='[1.0.1,1.0.2)',\
	org.apache.felix.scr; version='[2.0.2,2.0.3)',\
	org.eclipse.equinox.metatype; version='[1.4.100,1.4.101)',\
	org.osgi.service.metatype; version='[1.3.0,1.3.1)',\
	osgi.enroute.examples.eval.command; version='[1.0.0,1.0.1)',\
	osgi.enroute.examples.eval.parsii.provider; version='[1.0.0,1.0.1)',\
	org.apache.felix.gogo.shell; version='[2.0.0,2.0.1)'
...
</code></pre></div></div>

<p>And then update the <code class="highlighter-rouge">osgi.enroute.examples.eval.bndrun</code> file with the returned <code class="highlighter-rouge">-runbundles</code> and run <code class="highlighter-rouge">mvn install</code> again.</p>

<p>We can then run the application:</p>

<div class="shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bndrun $ java -jar osgi.enroute.examples.eval.jar
	         ____             _       
   ___ _ __ |  _ \ ___  _   _| |_ ___ 
  / _ \ '_ \| |_) / _ \| | | | __/ _ \
 |  __/ | | |  _ &lt; (_) | |_| | |_  __/
  \___|_| |_|_| \_\___/ \__,_|\__\___|
              http://enroute.osgi.org/
G! eval sin(pi)
1.2246467991473532E-16
G! eval cos(pi)
-1.0
G! 
</code></pre></div></div>

<h2 id="what-did-we-learn-in-this-section">What did We Learn in this Section?</h2>

<p>We created a new provider that used an external dependency. We needed to include
the code from this dependency inside our new bundle because the Parsii JAR does
not contain any OSGi metadata.</p>

<p>We then added this new project to the modules and updated the bndrun project
to use the new Parsii provider.</p>

<p>And it worked!</p>


		    </div>
			<div class="col hide-on-med-and-down l2">
				<div id="toc-wrapper" class="toc-wrapper pin-top">
				  <ul id="toc" class="section table-of-contents">
					
				  </ul>
				</div>
			</div>
			
			
				
				<div class="col s6 left-align hide-on-large-only show-on-med-and-down"><a href="command.html"><i class="large material-icons">keyboard_arrow_left</i></a></div>
			
			
				<div class="col s6  right-align hide-on-large-only show-on-med-and-down"><a href="web.html"><i class="large material-icons">keyboard_arrow_right</i></a></div>
			
			
			
				<div class="prev-nav hide-on-med-and-down"><a href="command.html"><i class="small material-icons">keyboard_arrow_left</i></a></div>
			
			
				<div class="next-nav hide-on-med-and-down"><a href="web.html"><i class="small material-icons">keyboard_arrow_right</i></a></div>
			
		
			
    </div> 
	
  </div>
  </main>
	<footer class="page-footer">
    <!--<div class="container">
      <div class="row">
        <div class="col l6 s12">
          <h5>Lorem Ipsum</h5>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
        </div>
      </div>
    </div>-->
    <div class="footer-copyright">
        <div class="container">
            <div>
				<span style="text-align: left; float: left; width: 30%;">
				Made with <a target="_blank" href="http://materializecss.com">Materialize</a>
				</span>
				<span style="text-align: center; float: left; width: 40%;">
				Copyright © 2018 <a href="https://www.osgi.org/">Thomas Driessen</a>
				</span>
                <span style="text-align: right; float: left; width: 30%;">
				Powered by <a target="_blank" href="http://jekyllrb.com/">Jekyll</a>
                </span>
            </div>
        </div>
    </div>
</footer>      
	<!--  Scripts-->  

<script src="/assets/js/jquery.min.js"></script>
<script src="/assets/js/materialize.min.js"></script>
<script src="/assets/js/init.js"></script>	
	<script src="/assets/js/content.js"></script>	
  </body>

</html>